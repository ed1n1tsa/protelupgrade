(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9222],{43431:(e,s,r)=>{Promise.resolve().then(r.bind(r,61837))},61837:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>d});var a=r(95155),l=r(12115),t=r(64983);function d(){let[e,s]=(0,l.useState)([]),[r,d]=(0,l.useState)(!0),[n,c]=(0,l.useState)(""),[i,o]=(0,l.useState)(null),[p,h]=(0,l.useState)({});(0,l.useEffect)(()=>{(async()=>{d(!0);let{data:e,error:r}=await t.supabase.from("orders").select("\n          id,\n          user_id,\n          total_amount,\n          status,\n          created_at,\n          customer_name,\n          phone,\n          address,\n          profiles (\n            email\n          )\n        ").order("created_at",{ascending:!1});r?console.error("Тапсырыстарды жүктеу қатесі:",r):s(e||[]),d(!1)})()},[]);let x=async(e,r)=>{let{error:a}=await t.supabase.from("orders").update({status:r}).eq("id",e);a?(alert("Күйін жаңарту қатесі"),console.error(a)):s(s=>s.map(s=>s.id===e?{...s,status:r}:s))},m=e=>{switch(e){case"paid":return"bg-green-100 text-green-700";case"в пути":return"bg-yellow-100 text-yellow-700";case"завершён":return"bg-blue-100 text-blue-700";case"отменён":return"bg-gray-200 text-gray-600";default:return"bg-red-100 text-red-700"}},u=async e=>{if(i===e)return void o(null);if(!p[e]){let{data:s,error:r}=await t.supabase.from("order_items").select("model, quantity, price").eq("order_id",e);if(r)return void console.error("Тауарларды жүктеу қатесі:",r);h(r=>({...r,[e]:s}))}o(e)},b=n?e.filter(e=>e.status===n):e;return(0,a.jsxs)("main",{className:"p-10",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Тапсырыстар"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"mr-2 font-medium",children:"Күй бойынша сүзгі:"}),(0,a.jsxs)("select",{value:n,onChange:e=>c(e.target.value),className:"border px-2 py-1 rounded",children:[(0,a.jsx)("option",{value:"",children:"Барлығы"}),(0,a.jsx)("option",{value:"в обработке",children:"Жаңа"}),(0,a.jsx)("option",{value:"paid",children:"Төленді"}),(0,a.jsx)("option",{value:"в пути",children:"Жолда"}),(0,a.jsx)("option",{value:"завершён",children:"Аяқталған"}),(0,a.jsx)("option",{value:"отменён",children:"Бас тартылды"})]})]}),r?(0,a.jsx)("p",{children:"Жүктелуде..."}):(0,a.jsxs)("table",{className:"w-full text-sm border bg-white",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"border px-2 py-1",children:"ID"}),(0,a.jsx)("th",{className:"border px-2 py-1",children:"Email"}),(0,a.jsx)("th",{className:"border px-2 py-1",children:"Аты"}),(0,a.jsx)("th",{className:"border px-2 py-1",children:"Телефон"}),(0,a.jsx)("th",{className:"border px-2 py-1",children:"Мекенжай"}),(0,a.jsx)("th",{className:"border px-2 py-1",children:"Сома"}),(0,a.jsx)("th",{className:"border px-2 py-1",children:"Күйі"}),(0,a.jsx)("th",{className:"border px-2 py-1",children:"Күні"}),(0,a.jsx)("th",{className:"border px-2 py-1",children:"Әрекет"})]})}),(0,a.jsx)("tbody",{children:b.map(e=>{var s;return(0,a.jsxs)(l.Fragment,{children:[(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("td",{className:"border px-2 py-1",children:e.id}),(0,a.jsx)("td",{className:"border px-2 py-1",children:(null==(s=e.profiles)?void 0:s.email)||"белгісіз"}),(0,a.jsx)("td",{className:"border px-2 py-1",children:e.customer_name}),(0,a.jsx)("td",{className:"border px-2 py-1",children:e.phone}),(0,a.jsx)("td",{className:"border px-2 py-1",children:e.address}),(0,a.jsxs)("td",{className:"border px-2 py-1",children:[e.total_amount," ₸"]}),(0,a.jsx)("td",{className:"border px-2 py-1 ".concat(m(e.status)," rounded"),children:(0,a.jsxs)("select",{value:e.status,onChange:s=>x(e.id,s.target.value),className:"bg-transparent",children:[(0,a.jsx)("option",{value:"в обработке",children:"Жаңа"}),(0,a.jsx)("option",{value:"paid",children:"Төленді"}),(0,a.jsx)("option",{value:"в пути",children:"Жолда"}),(0,a.jsx)("option",{value:"завершён",children:"Аяқталған"}),(0,a.jsx)("option",{value:"отменён",children:"Бас тартылды"})]})}),(0,a.jsx)("td",{className:"border px-2 py-1",children:new Date(e.created_at).toLocaleString()}),(0,a.jsx)("td",{className:"border px-2 py-1",children:(0,a.jsx)("button",{onClick:()=>u(e.id),className:"text-blue-600 hover:underline",children:i===e.id?"Жасыру":"Толығырақ"})})]}),i===e.id&&p[e.id]&&(0,a.jsx)("tr",{className:"bg-gray-50",children:(0,a.jsxs)("td",{colSpan:9,className:"p-4",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"Тапсырыстағы тауарлар:"}),(0,a.jsx)("ul",{className:"space-y-1",children:p[e.id].map((e,s)=>(0,a.jsxs)("li",{className:"text-sm",children:[e.model," — ",e.quantity," дана \xd7 ",e.price," ₸"]},s))})]})})]},e.id)})})]})]})}},64983:(e,s,r)=>{"use strict";r.r(s),r.d(s,{supabase:()=>a});let a=(0,r(34982).UU)("https://fjzbgaflzavzcwfoozcs.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZqemJnYWZsemF2emN3Zm9vemNzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDczOTM4ODMsImV4cCI6MjA2Mjk2OTg4M30.mTC_-_hacoYgO4gAhXE1A9QoW-V6oS6UNfozzlrh_w4")}},e=>{var s=s=>e(e.s=s);e.O(0,[4982,8441,1684,7358],()=>s(43431)),_N_E=e.O()}]);