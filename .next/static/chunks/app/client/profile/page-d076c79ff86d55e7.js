(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2530],{9767:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});var r=t(95155),n=t(12270),o=t(12115);let i=t(64983).supabase;function a(){let e=(0,n.useUser)(),[s,t]=(0,o.useState)(0);(0,o.useEffect)(()=>{(async()=>{if(!e)return;let{count:s,error:r}=await i.from("orders").select("*",{count:"exact",head:!0}).eq("user_id",e.id);r||null===s||t(s)})()},[e]);let a=async()=>{await i.auth.signOut(),window.location.href="/"};return e?(0,r.jsxs)("div",{className:"max-w-2xl mx-auto p-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Профиль"}),(0,r.jsxs)("p",{className:"mb-2",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Email:"})," ",e.email]}),(0,r.jsxs)("p",{className:"mb-4",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Всего заказов:"})," ",s]}),(0,r.jsx)("button",{onClick:a,className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition",children:"Выйти"})]}):(0,r.jsx)("div",{className:"p-6 text-center text-gray-500",children:"Пожалуйста, войдите в аккаунт"})}},12270:(e,s,t)=>{"use strict";var r=Object.defineProperty,n=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,a=(e,s,t)=>new Promise((r,n)=>{var o=e=>{try{a(t.next(e))}catch(e){n(e)}},i=e=>{try{a(t.throw(e))}catch(e){n(e)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,i);a((t=t.apply(e,s)).next())}),u={};((e,s)=>{for(var t in s)r(e,t,{get:s[t],enumerable:!0})})(u,{SessionContextProvider:()=>h,useSession:()=>b,useSessionContext:()=>m,useSupabaseClient:()=>f,useUser:()=>p}),e.exports=((e,s,t,a)=>{if(s&&"object"==typeof s||"function"==typeof s)for(let t of o(s))i.call(e,t)||void 0===t||r(e,t,{get:()=>s[t],enumerable:!(a=n(s,t))||a.enumerable});return e})(r({},"__esModule",{value:!0}),u);var l=t(12115),c=t(95155),d=(0,l.createContext)({isLoading:!0,session:null,error:null,supabaseClient:{}}),h=({supabaseClient:e,initialSession:s=null,children:t})=>{let[r,n]=(0,l.useState)(s),[o,i]=(0,l.useState)(!s),[u,h]=(0,l.useState)();(0,l.useEffect)(()=>{!r&&s&&n(s)},[r,s]),(0,l.useEffect)(()=>{let s=!0;return!function(){a(this,null,function*(){let{data:{session:t},error:r}=yield e.auth.getSession();if(s){if(r){h(r),i(!1);return}n(t),i(!1)}})}(),()=>{s=!1}},[]),(0,l.useEffect)(()=>{let{data:{subscription:s}}=e.auth.onAuthStateChange((e,s)=>{s&&("SIGNED_IN"===e||"TOKEN_REFRESHED"===e||"USER_UPDATED"===e)&&n(s),"SIGNED_OUT"===e&&n(null)});return()=>{s.unsubscribe()}},[]);let m=(0,l.useMemo)(()=>o?{isLoading:!0,session:null,error:null,supabaseClient:e}:u?{isLoading:!1,session:null,error:u,supabaseClient:e}:{isLoading:!1,session:r,error:null,supabaseClient:e},[o,r,u]);return(0,c.jsx)(d.Provider,{value:m,children:t})},m=()=>{let e=(0,l.useContext)(d);if(void 0===e)throw Error("useSessionContext must be used within a SessionContextProvider.");return e};function f(){let e=(0,l.useContext)(d);if(void 0===e)throw Error("useSupabaseClient must be used within a SessionContextProvider.");return e.supabaseClient}var b=()=>{let e=(0,l.useContext)(d);if(void 0===e)throw Error("useSession must be used within a SessionContextProvider.");return e.session},p=()=>{var e,s;let t=(0,l.useContext)(d);if(void 0===t)throw Error("useUser must be used within a SessionContextProvider.");return null!=(s=null==(e=t.session)?void 0:e.user)?s:null}},64983:(e,s,t)=>{"use strict";t.r(s),t.d(s,{supabase:()=>r});let r=(0,t(34982).UU)("https://fjzbgaflzavzcwfoozcs.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZqemJnYWZsemF2emN3Zm9vemNzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDczOTM4ODMsImV4cCI6MjA2Mjk2OTg4M30.mTC_-_hacoYgO4gAhXE1A9QoW-V6oS6UNfozzlrh_w4")},71472:(e,s,t)=>{Promise.resolve().then(t.bind(t,9767))}},e=>{var s=s=>e(e.s=s);e.O(0,[4982,8441,1684,7358],()=>s(71472)),_N_E=e.O()}]);