(()=>{var e={};e.id=966,e.ids=[966],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9885:(e,r,s)=>{Promise.resolve().then(s.bind(s,88915))},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},14621:(e,r,s)=>{Promise.resolve().then(s.bind(s,98253))},16389:(e,r,s)=>{"use strict";s.d(r,{A:()=>p});var t=s(60687),a=s(85814),i=s.n(a),n=s(43210),o=s(7163);let{LogOut:l,Menu:d}=s(46560),c=s(56757).A;function p(){let[e,r]=(0,n.useState)(!1),s=async()=>{await o.supabase.auth.signOut(),location.href="/"};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("header",{className:"bg-gray-800 text-white px-6 py-4 flex justify-between items-center shadow-md",children:[(0,t.jsx)(i(),{href:"/admin",className:"text-xl font-bold",children:"ProTel Әкімші"}),(0,t.jsxs)("nav",{className:"hidden lg:flex gap-6 text-sm",children:[(0,t.jsx)(i(),{href:"/kz/admin",className:"hover:text-orange-400",children:"Басқару"}),(0,t.jsx)(i(),{href:"/kz/admin/products",className:"hover:text-orange-400",children:"Тауарлар"}),(0,t.jsx)(i(),{href:"/kz/admin/upload",className:"hover:text-orange-400",children:"Жүктеу"}),(0,t.jsx)(i(),{href:"/kz/admin/users",className:"hover:text-orange-400",children:"Қолданушылар"}),(0,t.jsx)(i(),{href:"/kz/admin/orders",className:"hover:text-orange-400",children:"Тапсырыстар"}),(0,t.jsx)(i(),{href:"/kz/admin/chat",className:"hover:text-orange-400",children:"Клиентпен чат"}),(0,t.jsx)(i(),{href:"/kz/admin/profile",className:"hover:text-orange-400",children:"Профиль"}),(0,t.jsxs)("button",{onClick:s,className:"hover:text-red-400 flex items-center gap-1",children:[(0,t.jsx)(l,{size:16})," Шығу"]})]}),(0,t.jsx)("button",{onClick:()=>r(!0),className:"lg:hidden text-white",children:(0,t.jsx)(d,{size:28})})]}),(0,t.jsx)(c,{isOpen:e,onClose:()=>r(!1)})]})}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21789:(e,r,s)=>{Promise.resolve().then(s.bind(s,8402))},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},41204:e=>{"use strict";e.exports=require("string_decoder")},42715:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>n.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d});var t=s(65239),a=s(48088),i=s(88170),n=s.n(i),o=s(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(r,l);let d={children:["",{children:["kz",{children:["admin",{children:["upload",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,98253)),"C:\\Users\\Raim\\Desktop\\protel-demo\\app\\kz\\admin\\upload\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,55794)),"C:\\Users\\Raim\\Desktop\\protel-demo\\app\\kz\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,80886)),"C:\\Users\\Raim\\Desktop\\protel-demo\\app\\kz\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,58014)),"C:\\Users\\Raim\\Desktop\\protel-demo\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\Raim\\Desktop\\protel-demo\\app\\kz\\admin\\upload\\page.tsx"],p={require:s,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/kz/admin/upload/page",pathname:"/kz/admin/upload",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},48524:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>i});var t=s(60687);let a=s(16389).A;function i({children:e}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a,{}),(0,t.jsx)("main",{children:e})]})}},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},55794:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>t});let t=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Raim\\\\Desktop\\\\protel-demo\\\\app\\\\kz\\\\admin\\\\layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Raim\\Desktop\\protel-demo\\app\\kz\\admin\\layout.tsx","default")},56757:(e,r,s)=>{"use strict";s.d(r,{A:()=>n});var t=s(60687);let a=s(46560).X,i=s(85814).default;function n({isOpen:e,onClose:r}){return e?(0,t.jsxs)("div",{className:"fixed inset-0 bg-white z-50 px-6 pt-6 pb-10 shadow-md overflow-auto lg:hidden",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("span",{className:"text-lg font-bold",children:"Әкімші мәзірі"}),(0,t.jsx)("button",{onClick:r,className:"ml-auto",children:(0,t.jsx)(a,{className:"w-6 h-6"})})]}),(0,t.jsxs)("ul",{className:"space-y-3 text-gray-800",children:[(0,t.jsx)("li",{children:(0,t.jsx)(i,{href:"/kz/admin",onClick:r,className:"block hover:text-orange-500",children:"Басқару"})}),(0,t.jsx)("li",{children:(0,t.jsx)(i,{href:"/kz/admin/products",onClick:r,className:"block hover:text-orange-500",children:"Тауарлар"})}),(0,t.jsx)("li",{children:(0,t.jsx)(i,{href:"/kz/admin/upload",onClick:r,className:"block hover:text-orange-500",children:"XML жүктеу"})}),(0,t.jsx)("li",{children:(0,t.jsx)(i,{href:"/kz/admin/users",onClick:r,className:"block hover:text-orange-500",children:"Қолданушылар"})}),(0,t.jsx)("li",{children:(0,t.jsx)(i,{href:"/kz/admin/orders",onClick:r,className:"block hover:text-orange-500",children:"Тапсырыстар"})}),(0,t.jsx)("li",{children:(0,t.jsx)(i,{href:"/kz/admin/profile",onClick:r,className:"block hover:text-orange-500",children:"Профиль"})}),(0,t.jsx)("li",{children:(0,t.jsx)("button",{onClick:async()=>{let{supabase:e}=s(7163);await e.auth.signOut(),window.location.href="/"},className:"text-red-600 hover:underline",children:"Шығу"})})]})]}):null}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66136:e=>{"use strict";e.exports=require("timers")},74075:e=>{"use strict";e.exports=require("zlib")},77821:(e,r,s)=>{Promise.resolve().then(s.bind(s,78972))},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},80886:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>n,metadata:()=>i});var t=s(37413);s(23141);var a=s(78972);let i={title:"ProTel Shop",description:"Онлайн магазин"};function n({children:e}){return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(a.Providers,{children:e})})}},81630:e=>{"use strict";e.exports=require("http")},84175:(e,r,s)=>{Promise.resolve().then(s.bind(s,55794))},88915:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>l});var t=s(60687),a=s(43210),i=s(85128),n=s.n(i),o=s(7163);function l(){let[e,r]=(0,a.useState)(null),[s,i]=(0,a.useState)(""),[l,d]=(0,a.useState)([]),c=async()=>{if(!e)return i("❌ Файл не выбран.");i("⏳ Чтение и обработка файла...");let r=await e.text();try{let e=new(n()).Parser({explicitArray:!1,trim:!0}),s=await e.parseStringPromise(r),t=s?.kaspi_catalog?.offers?.offer?Array.isArray(s.kaspi_catalog.offers.offer)?s.kaspi_catalog.offers.offer:[s.kaspi_catalog.offers.offer]:null;if(!t)return void i("❌ Не удалось найти товары в XML.");let a=t.map(e=>{let r=e.cityprices?.cityprice,s=e.availabilities?.availability,t=e.model||"",a=e.img?[e.img]:[];return{sku:e.$.sku,model:t,brand:function(e){let r=e.toLowerCase();return r.includes("iphone")||r.includes("apple")?"Apple":r.includes("samsung")?"Samsung":r.includes("redmi")||r.includes("xiaomi")?"Xiaomi":r.includes("realme")?"Realme":r.includes("jbl")?"JBL":r.includes("huawei")?"Huawei":r.includes("honor")?"Honor":r.includes("asus")?"ASUS":"Неизвестно"}(t),price:Array.isArray(r)?parseFloat(r[0]._):parseFloat(r._),stock_count:s?.$?.stockCount?parseInt(s.$.stockCount):0,available:s?.$?.available==="yes",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),img:a.length>0?a[0]:null}}).filter(e=>e.sku&&"number"==typeof e.price&&!isNaN(e.price)),{error:l}=await o.supabase.from("products").upsert(a,{onConflict:"sku"});l?(console.error(l),i(`❌ Ошибка при вставке в базу: ${l.message}`)):(i(`✅ Загружено товаров: ${a.length}`),d(a.slice(0,10)))}catch(e){console.error(e),i("❌ Ошибка при парсинге XML.")}};return(0,t.jsxs)("main",{className:"p-6 sm:p-10",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Загрузка XML товаров"}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4 mb-6",children:[(0,t.jsx)("input",{type:"file",accept:".xml",onChange:e=>{r(e.target.files?.[0]||null),i("")}}),(0,t.jsx)("button",{onClick:c,className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700",children:"Загрузить в базу"})]}),s&&(0,t.jsx)("p",{className:"text-blue-600 mb-4",children:s}),l.length>0&&(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Превью товаров:"}),(0,t.jsxs)("table",{className:"w-full text-sm bg-white border",children:[(0,t.jsx)("thead",{className:"bg-gray-100",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"border px-2 py-1",children:"SKU"}),(0,t.jsx)("th",{className:"border px-2 py-1",children:"Модель"}),(0,t.jsx)("th",{className:"border px-2 py-1",children:"Бренд"}),(0,t.jsx)("th",{className:"border px-2 py-1",children:"Цена"}),(0,t.jsx)("th",{className:"border px-2 py-1",children:"В наличии"}),(0,t.jsx)("th",{className:"border px-2 py-1",children:"Остаток"}),(0,t.jsx)("th",{className:"border px-2 py-1",children:"Фото"})]})}),(0,t.jsx)("tbody",{children:l.map((e,r)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"border px-2 py-1",children:e.sku}),(0,t.jsx)("td",{className:"border px-2 py-1",children:e.model}),(0,t.jsx)("td",{className:"border px-2 py-1",children:e.brand}),(0,t.jsx)("td",{className:"border px-2 py-1",children:e.price}),(0,t.jsx)("td",{className:"border px-2 py-1",children:e.available?"Да":"Нет"}),(0,t.jsx)("td",{className:"border px-2 py-1",children:e.stock_count}),(0,t.jsx)("td",{className:"border px-2 py-1",children:e.img&&(0,t.jsx)("img",{src:e.img,alt:"Product",className:"w-16 h-16"})})]},r))})]})]})]})}},91645:e=>{"use strict";e.exports=require("net")},92423:(e,r,s)=>{Promise.resolve().then(s.bind(s,48524))},94735:e=>{"use strict";e.exports=require("events")},98253:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>t});let t=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Raim\\\\Desktop\\\\protel-demo\\\\app\\\\kz\\\\admin\\\\upload\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Raim\\Desktop\\protel-demo\\app\\kz\\admin\\upload\\page.tsx","default")}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[557,128,380],()=>s(42715));module.exports=t})();